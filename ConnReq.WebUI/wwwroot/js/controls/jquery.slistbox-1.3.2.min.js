(function(n){"use strict";function f(t,i){var f=n(t).data("slistbox"),u,r,e,o,s;if(f!==null&&f!==undefined){if(u=n("<select>",n(t)).appendTo(t),i.length===0){n(t).hide();return}for(r=0;r<i.length;r++)e=n("<option>").attr("value",i[r].Value).html(i[r].Text).appendTo(u),i[r].Selected===!0&&e.prop("selected","selected"),i[r].Enabled===!1&&e.prop("disabled","disabled");if(f.autofocus===!0&&u.prop("autofocus","autofocus"),n(t).show(),f.multiple===!0){o=u.position().top+u.height()-8;u.prop("multiple",!0).prop("size",f.size);s=n('<div style="display: block;">').appendTo(t);n("<span>").appendTo(s).addClass("glyphicon glyphicon-check").prop("title","Выбрать все").css("top",-o).on("click",function(){n("select > option",n(t)).prop("selected","selected").parent().focus()});n('<span style="padding: 10px;">').appendTo(s).addClass("glyphicon glyphicon-remove-circle").prop("title","Сбросить все").css("top",-o).on("click",function(){n("select > option",n(t)).prop("selected","").parent().focus()})}}}function e(t,i){var e,u,f;if(i.length===0){n(t).slistbox("hide","fast");return}if(n(t).slistbox("show","fast"),n("option",n(t)).length>=i.length)n("option",n(t)).each(function(t,u){t>=i.length?n(u).hide():(n(u).attr("value",i[t].Value).html(i[t].Text),n(u).is(":hidden")&&n(u).show(),r(n(u),i[t]))});else for(n("option",n(t)).each(function(t,u){t<i.length&&(n(u).attr("value",i[t].Value).html(i[t].Text),n(u).is(":hidden")&&n(u).show(),r(n(u),i[t]))}),e=n("select",n(t)),u=n("option",n(t)).length;u<i.length;u++)f=n("<option>").attr("value",i[u].Value).html(i[u].Text).appendTo(e),i[u].Selected===!0&&f.prop("selected","selected"),i[u].Enabled===!1&&f.prop("disabled","disabled")}function r(n,t){t.Selected===!0?n.prop("selected","selected"):n.prop("selected","");t.Enabled===!1?n.prop("disabled","disabled"):n.prop("disabled","")}function u(t,i){return n.ajax({async:i,type:"GET",headers:{"Cache-Control":"no-cache no-store"},url:t,cashe:!1,error:function(n){alert("Ошибка чтения. url:"+t+" Статус -  "+n.statusText)}})}var i={},t;n.ajaxSetup({cache:!1});t={init:function(t){i=n.extend(!0,{},{url:null,async:!0,multiple:!1,size:5},t);n(this).data("slistbox",i);var r=this;u(this.data("slistbox").url,this.data("slistbox").async).then(function(n){f(r,n)})},refresh:function(){var n=this;u(this.data("slistbox").url).then(function(t){e(n,t)})},getSelected:function(){var t=[];return n("option:selected",n(this)).each(function(){t.push(n(this).val())}),t},setSelect:function(t){n("option:selected",n(this)).removeAttr("selected");n("option",n(this)).each(function(i,r){n(r).val()===t&&n(r).attr("selected","selected")})},getSelectedText:function(){var t=n("option:selected",n(this));return t===null||t===undefined?"":t.html()},hide:function(t){n(this).hide(t);this.data("slistbox").multiple===!0&&n("span",n(this)).hide(t)},show:function(t){n(this).show(t);this.data("slistbox").multiple===!0&&n("span",n(this)).show(t)}};n.fn.slistbox=function(i){if(t[i])return t[i].apply(this,Array.prototype.slice.call(arguments,1));if(typeof i!="object"&&i)n.error("Метод "+i+" не существует в jQuery.slistbox");else return t.init.apply(this,arguments)}})(jQuery);