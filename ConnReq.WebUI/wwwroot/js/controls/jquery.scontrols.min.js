(function(n){"use strict";function u(){var n=window.navigator.userAgent,i=n.indexOf("MSIE "),u,r,t;return i>0?parseInt(n.substring(i+5,n.indexOf(".",i)),10):(u=n.indexOf("Trident/"),u>0)?(r=n.indexOf("rv:"),parseInt(n.substring(r+3,n.indexOf(".",r)),10)):(t=n.indexOf("Edge/"),t>0)?parseInt(n.substring(t+5,n.indexOf(".",t)),10):!1}function r(t){var i=t.data("slistbox");n.ajax({type:"GET",headers:{"Cache-Control":"no-cache no-store"},url:i.url+"?t="+(new Date).getTime(),cashe:!1,success:function(r){var f,u,e;if(r.indexOf("<!DOCTYPE ")>=0){document.open();document.write(r);document.close();return}if(f=n(i.selector+" > select"),n(t).show("slow"),f.length==0&&(f=n("<select>").appendTo(t)),i.multiple===!0&&f.attr("size",i.size).attr("multiple",null),r.length>0)for(u=0;u<r.length;u++)e=n("<option>").attr("value",r[u].Value).html(r[u].Text).appendTo(f),r[u].Selected===!0&&e.attr("selected",""),r[u].Enabled===!1&&e.attr("disabled","");else n(t).hide("slow")},error:function(n){alert("Ошибка чтения. url:"+i.url+" Статус -  "+n.status+" Техт: "+n.responseText)}})}var i={},t;n.ajaxSetup({cache:!1});t={init:function(t){i=n.extend({url:null,multiple:!1,selector:null,size:3},t);i.selector=this.selector;this.data("slistbox",i);r(this)},refresh:function(){n(this.data("slistbox").selector+" > select").children().remove();r(this);u()>0&&location.reload()}};n.fn.slistbox=function(i){if(t[i])return t[i].apply(this,Array.prototype.slice.call(arguments,1));if(typeof i!="object"&&i)n.error("Метод "+i+" не существует в jQuery.slistbox");else return t.init.apply(this,arguments)}})(jQuery),function(n){"use strict";n.stree=n.stree||{};n.fn.stree=function(t){function u(t){var r,u,o;if(t.length===0){n("#"+i.containerId+" ").addClass("alert-danger").html("Нет данных").hide("slow");return}if(n("#"+i.containerId+" ").removeClass("alert-danger").html("").show("slow"),t[0].ID===undefined){alert("ID undefined!");return}r="#"+i.containerId+" ";i.mode==="multiSelect"&&(n('<input type="checkbox" id="ch-setsel" >').addClass("chck-set").appendTo("#"+i.containerId),n('<label for="ch-setsel">').appendTo("#"+i.containerId).html(i.defText));i.mode==="comboTree"?(u=n("<div>").addClass("TreeCombo").appendTo("#"+i.containerId),n('<input type="text">').addClass("TextItem").attr("disabled","").attr("value",i.defText).appendTo(u),n("<img>").attr("src",i.imgPath+"/arrow-down.png").addClass("CtrlItem").appendTo(u).click(function(){n(r+"div.TreeContainer").is(":visible")?n(r+"div.TreeContainer").hide():n(r+"div.TreeContainer").show()}),u=n("<div>").addClass("TreeContainer").css("position","absolute").css("z-index","2").appendTo("#"+i.containerId)):u=n("<div>").addClass("TreeContainer").appendTo("#"+i.containerId);u=n("<ul>").addClass("tree").appendTo(u);f(u,t);n(r+"ul.tree li a").click(function(){}).mousedown(function(t){t.which===1&&(n(r+"ul.tree li").find("a").each(function(){i.mode!=="multiSelect"&&n(this).removeClass()}),(i.mode==="comboTree"||i.mode==="singleSelect")&&(n(this).hasClass("jqtree-selected")?n(this).removeClass():n(this).addClass("jqtree-selected"),i.mode==="comboTree"&&(n(r+"div.TreeCombo input.TextItem").val(n(this).html()),n(r+"div.TreeContainer").hide())),i.mode==="multiSelect"&&n(this).addClass("jqtree-selected"),n("#"+i.containerId).trigger("selchange.stree",n(this).attr("id")))});n(r+" input.chck-set").click(function(){n(this).prop("checked")?n(r+"ul.tree li").find("a").each(function(){n(this).addClass("jqtree-selected")}):n(r+"ul.tree li").find("a").each(function(){n(this).removeClass()})});o=n(r+"div.TreeContainer").offset().top;n(r+"div.TreeContainer li").find("a").each(function(t,i){i.className==="jqtree-selected"&&n(r+"div.TreeContainer").scrollTop(n(this).offset().top-o)});n(r+"ul.tree li").each(function(){n(this).children("img.parentNode").click(function(){e(this)})})}function f(t,u){var e,o,s;if(r<i.maxLevel){for(r++,e=0;e<u.length;e++)o=n("<li><\/li>").appendTo(t),u[e].ToolTip&&o.attr("title",u[e].ToolTip),u[e].Children.length>0?(s=n("<img><\/img>").addClass("parentNode").appendTo(o),u[e].CustomIcon.length>0&&n("<img><\/img>").attr("src",u[e].CustomIcon).appendTo(o),u[e].Selected?(i.mode==="comboTree"&&n("input.TextItem").attr("value",u[e].Text),u[e].Enabled===!0?n("<a id="+u[e].ID+">"+u[e].Text+"<\/a>").addClass("jqtree-selected").appendTo(o).trigger("click"):n("<label id="+u[e].ID+">"+u[e].Text+"<\/label>").appendTo(o),i.mode==="comboTree"&&n("#"+i.containerId+" div.TreeContainer").hide()):u[e].Enabled===!0?n("<a id="+u[e].ID+">"+u[e].Text+"<\/a>").appendTo(o).trigger("click"):n("<label id="+u[e].ID+">"+u[e].Text+"<\/label>").appendTo(o),u[e].Opened===!1?(s.attr("src",i.imgPath+"/plus.gif"),o=n("<ul><\/ul>").attr("hidden","hidden").appendTo(o)):(s.attr("src",i.imgPath+"/minus.gif"),o=n("<ul><\/ul>").appendTo(o)),f(o,u[e].Children)):(u[e].CustomIcon>0&&n("<img><\/img>").attr("src",u[e].CustomIcon).appendTo(o),u[e].Selected?(i.mode==="comboTree"&&n("input.TextItem").attr("value",u[e].Text),u[e].Enabled===!0?n("<a id="+u[e].ID+">"+u[e].Text+"<\/a>").addClass("jqtree-selected").appendTo(o).trigger("click"):n("<label id="+u[e].ID+">"+u[e].Text+"<\/label>").appendTo(o),i.mode==="comboTree"&&n("#"+i.containerId+" div.TreeContainer").hide()):u[e].Enabled===!0?n("<a id="+u[e].ID+">"+u[e].Text+"<\/a>").appendTo(o).trigger("click"):n("<label id="+u[e].ID+">"+u[e].Text+"<\/label>").appendTo(o));r--}}function e(t){n(t).attr("src")===i.imgPath+"/plus.gif"?n(t).attr("src",i.imgPath+"/minus.gif"):n(t).attr("src",i.imgPath+"/plus.gif");n(t).next("a").next("ul").is(":visible")?n(t).next("a").next("ul").hide("slow"):n(t).next("a").next("ul").show("slow");n(t).next("img").next("a").next("ul").is(":visible")?n(t).next("img").next("a").next("ul").hide("slow"):n(t).next("img").next("a").next("ul").show("slow");n(t).next("label").next("ul").is(":visible")?n(t).next("label").next("ul").hide("slow"):n(t).next("label").next("ul").show("slow")}var i=n.extend({url:null,mode:"singleSelect",defText:"Выберите элемент дерева",imgPath:null,containerId:null,maxLevel:20,CustomIcon:null},t||{}),r;return n.fn.getSelIds=function(){var t=[];return n("#"+i.containerId+" ul.tree li a.jqtree-selected").each(function(){t.push(n(this).attr("id"))}),t},n.fn.getFirstSelText=function(){return n("#"+i.containerId+" ul.tree li a.jqtree-selected").html()},n.ajax({type:"GET",url:i.url,success:function(n){u(n)},error:function(n){alert("Ошибка. url: "+i.url+" responseText "+n.responseText)}}),n.extend(n.stree,{refreshTree:function(t,r,f){i.containerId=r;i.mode=f;n("#"+i.containerId).children("*").remove();u(t)}}),r=0,this.each(function(){})};n.fn.refreshData=function(t,i,r){n.ajax({type:"GET",url:t,success:function(t){n.stree.refreshTree(t,i,r)},error:function(n){alert("Ошибка запроса refreshData. url: "+settings.url+" Статус -  "+n.status+" responseText: "+n.responseText)}})}}(jQuery),function(n){"use strict";function r(i){var f=n(i).find("li").first(),r,u;if(t.menu!==null&&t.menu!==undefined)for(r=0;r<t.menu.length;r++)u='<li id="'+t.menu[r].id,u+='"><a href="'+t.menu[r].href+'"',u+=' title="',u+=t.menu[r].title,u+='">'+t.menu[r].text+"<\/a><\/li>",f.before(u);t.ddmenu!==null&&t.ddmenu!==undefined&&n("ul.nav.navbar-nav").find("li").each(function(i,r){if(r.id===t.ddmenu.beforeId.toString()){var f=n("<li><\/li>").insertBefore(r).addClass("dropdown").attr("id",t.ddmenu.id),e=n('<a href="#" class="dropdown-toggle" id="drop1" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><\/a>').appendTo(f).html(t.ddmenu.ddName).append('<span class="caret"><\/span>'),o=n('<ul class="dropdown-menu" aria-labelledby="drop1"><\/ul>').insertAfter(e),u;n.each(t.ddmenu.actions,function(i,r){i===t.ddmenu.separPos&&n('<li role="separator" class="divider"><\/li>').insertAfter(u);u=n("<li><\/li>").appendTo(o);r.title!==null&&u.attr("title",r.title);(r.show===!1||r.show===undefined)&&u.attr("hidden","hidden");var f=n("<a><\/a>").appendTo(u).attr("id",r.id).html(r.text);r.href!==null&&r.href!==undefined&&f.attr("href",r.href)})}t.ddmenu.show!==!0&&n("li.dropdown").addClass("disabled")});n("ul.dropdown-menu li a").click(function(){}).mousedown(function(t){if(t.which===1){var i=n(this).attr("id");n("div.navbar").trigger("selchange.sddMenu",i)}})}var t={},i={init:function(i){t=n.extend({menu:[{id:0,href:"/",text:"",title:"",show:!0}],ddmenu:{id:0,beforeId:0,separPos:null,ddName:"Действия",actions:[{id:0,href:"/",text:"",title:"",show:!0}]}},i);this.data("sMenu",t);r(this);n(this).sMenu("changeMenu")},hide:function(t){n("ul.dropdown-menu li a").each(function(i,r){n(r).attr("id").toString()===t.toString()&&n(r).parent().attr("hidden","hidden")});n("li#"+t).addClass("hidden-sm hidden-md hidden-lg")},show:function(t){n("ul.dropdown-menu li a").each(function(i,r){n(r).attr("id").toString()===t.toString()&&n(r).parent().removeAttr("hidden")});n("li#"+t).removeClass("hidden-sm hidden-md hidden-lg")},changeMenu:function(){var i=n(this);n.ajax({url:t.ddmenu.url,type:"GET",cache:!1,success:function(n){for(var t=0;t<n.ddList.length;t++)switch(n.ddList[t].Show){case!0:i.sMenu("show",n.ddList[t].Item);break;case!1:i.sMenu("hide",n.ddList[t].Item)}},error:function(n){alert("Ошибка чтения сатуса пунктов меню. Статус -  "+n.status+" Техт: "+n.responseText)}})}};n.fn.sMenu=function(t){if(i[t])return i[t].apply(this,Array.prototype.slice.call(arguments,1));if(typeof t!="object"&&t)n.error("Метод "+t+" не существует в jQuery.sddMenu");else return i.init.apply(this,arguments)}}(jQuery),function(n){"use strict";function c(t,r){var a=t.toString(),f,v,y,e,h,o,u,s,l,p,c;if(a.indexOf("<!DOCTYPE")>=0){document.open();document.write(a);document.close();return}for(f=n("<div>").addClass("sgrid_caption").html(t.Caption).appendTo(r),f=n("<div>").addClass("sgrid_container").appendTo(r),f.css("overflow","auto"),v=n(r).sgrid("getSettings","nameRow4Modal"),i.length=0,f=n("<table>").addClass("scroll").appendTo(f),y=n("<thead>").appendTo(f),e=0;e<t.HeaderRows.length;e++)for(h=n("<tr>").appendTo(y),o=0;o<t.Columns.length;o++)u=t.HeaderRows[e]+"_"+t.Columns[o],s=n('<th scope="col">').attr("colspan",t.Header[u].ColSpan).attr("rowspan",t.Header[u].RowSpan).attr("id",u+"_th").appendTo(h),t.Header[u].ShowVertical===!0?(h.hasClass("vertical")||h.addClass("vertical"),n("<span>").addClass("vertical").html(t.Header[u].Value).appendTo(s)):(s.html(t.Header[u].Value),t.HeaderRows[e].toString()===v&&i.push(t.Header[u].Value)),e===0&&n(r).sgrid("getSettings","readOnly")===!0&&n(r).sgrid("getSettings","hasTreeColumn")===!1&&(n("<span>").addClass("glyphicon glyphicon-sort").appendTo(s),l=n(r).sgrid("getSettings","filterColumns"),l!=null&&l.indexOf(t.Columns[o])>=0&&n("<span>").addClass("glyphicon glyphicon-filter").prependTo(s));p=n("<tbody>").attr("id","stbody").appendTo(f);c=0;n("table th span.vertical").each(function(){n(this).outerWidth()>c&&(c=n(this).outerWidth())});n("table tr.vertical th").height(c+10)}function l(t,i,r){for(var p,h,s,f,w,tt,v,c,b,l=new Date,k=l.getDate(),d=l.getMonth()+1,g=l.getFullYear(),y=k+r+d+r+g,nt=n(i).find("table.scroll tbody"),a=0;a<t.Rows.length;a++)for(p=n("<tr>").appendTo(nt),h=0;h<t.Columns.length;h++){var o=t.Rows[a]+"_"+t.Columns[h],e=n("<td>").attr("id","td"+o).appendTo(p),u=t.Cells[o];if(u!==undefined){switch(u.Mode){case 0:e.addClass("cell_disabled").attr("dataType",u.Type).html(u.Value);(u.Type===1||u.Type===5||u.Type===6)&&e.addClass("sform-right-align");break;case 1:case 4:e.addClass("cell_input");break;case 2:e.addClass("cell_calculated");break;case 3:case 5:e.addClass("cell_fromhistory")}s=(u.Mode==1||u.Mode==3)&&n(i).sgrid("getSettings","readOnly")===!1;u.Tooltip!==undefined&&u.Tooltip!==null&&u.Tooltip.length>0&&e.attr("title",u.Tooltip);f=n("<input>").attr("name",o+"_"+u.Type).attr("id",o);switch(u.Type){case 1:f.attr("type","text").addClass("sform-right-align").attr("value",u.Value);s?f.attr("placeholder","00,00"):f.attr("disabled","disabled");f.appendTo(e);break;case 2:s?f.attr("type","text").attr("value",u.Value).attr("placeholder","введите текст").appendTo(e):u.Mode===4||u.Mode===5?(f.attr("type","text").addClass("sform-left-align").attr("value",u.Value).attr("disabled","disabled"),f.appendTo(e)):e.addClass("sform-left-align").html(u.Value);break;case 3:f.attr("type","text").attr("value",u.Value);s?f.attr("placeholder",y):f.attr("disabled","disabled");f.appendTo(e);break;case 4:f.attr("type","text").attr("value",u.Value);s?f.attr("placeholder",y+" 00:00:00"):f.attr("disabled","disabled");f.appendTo(e);break;case 5:f.attr("type","text").addClass("sform-right-align").attr("value",u.Value);s?f.attr("placeholder","введите целое"):f.attr("disabled","disabled");f.appendTo(e);break;case 6:f.attr("type","text").addClass("sform-right-align").attr("value",u.Value);s?f.attr("min",u.Min).attr("max",u.Max).attr("placeholder","целое от "+u.Min+" до "+u.Max):f.attr("disabled","disabled");f.appendTo(e);break;case 7:f.attr("type","checkbox").attr("name",o+"_"+u.Type).appendTo(e).after(u.Value);f.prop("checked",u.BoolValue);s||f.attr("disabled","disabled");break;case 8:w=n("<textarea>").attr("id",o).attr("name",o+"_"+u.Type).attr("rows",u.Rows).attr("cols",u.Cols).html(u.Value).appendTo(e);s||w.attr("disabled","disabled");break;case 9:tt=n("<img>").attr("src",u.Value).attr("id",o).appendTo(e);break;case 10:v=n("<select>").attr("name",o+"_"+u.Type).attr("id",o).appendTo(e);s||v.attr("disabled","disabled");for(c in u.options)b=n("<option>").attr("value",c).html(u.options[c]).appendTo(v),c===u.Value&&b.attr("selected","selected");break;case 11:n("<a>").attr("id",o).attr("name",o+"_"+u.Type).attr("class","btn btn-primary").attr("href",u.Url).html(u.Value).appendTo(e)}}}t.VarRowCount===!0&&(n(i).sgrid("addRemoveIcon"),n(i).sgrid("onAddRowEvnt"),n(i).sgrid("onRemoveRowEvnt"))}function a(t,i){for(var c,e,f,s,a=n(i).find("table.scroll tbody"),h=0;h<t.Rows.length;h++)for(c=n("<tr>").appendTo(a),e=0;e<t.Columns.length;e++){var u=n("<td>").appendTo(c),l=t.Rows[h]+"_"+t.Columns[e],r=t.Cells[l];if(r!==undefined){u.attr("id","td"+l).attr("dataType",r.Type);(r.Type===1||r.Type===5||r.Type===6)&&u.addClass("sform-right-align");f=r.Value;switch(r.Type){case 7:f=r.BoolValue?"да":"нет";u.addClass("cell_disabled").html(f);break;case 10:f=r.options[r.Value];u.addClass("cell_disabled").html(f);break;case 12:u.addClass("cell_disabled").html(f);var o=n(i).sgrid("getSettings","expanderTemplate"),v=n(i).sgrid("getSettings","indentTemplate"),y=n(i).sgrid("getSettings","expanderExpandedClass");for(o=n(o).prependTo(u),u.parent().attr("row",r.Row).attr("parentRow",r.ParentRow),s=0;s<=r.Level;s++)r.HasChildren&&o.addClass("glyphicon glyphicon-minus"),s!==0&&n(v).insertBefore(o);break;default:u.addClass("cell_disabled").html(f)}}}}function v(t){var i,r,u;n("<div>").addClass("overlay").attr("title","Ошибка ввода").appendTo(t);i=n("<div>").addClass("popup").appendTo(t);n("<div>").addClass("close_window").html("X").appendTo(i);n("<p>").attr("id","inputerror").appendTo(i);r=t.sgrid("getSettings","dateDelimiter");u=t.sgrid("getSettings","decimalDelimiter");n("#stbody input,#stbody textarea,#stbody select").bind("change",function(){var i=n(this).prop("name").split("_",3),f=n(this).prop("value").toString(),e,s,h;i.length===3&&(e=n(this).offset().left,s=n(this).offset().top,p(i[2],f,n(this).prop("min"),n(this).prop("max"),r,u)?(i[2]==="7"&&(f=n(this).prop("checked").toString()),n.ajax({type:"POST",url:t.sgrid("getSettings","root")+t.sgrid("getSettings","posturl"),data:"r="+i[0]+"&c="+i[1]+"&val="+f,success:function(t){if(t.error!==undefined&&t.error!==null)o(e,s,t.error);else{for(var i=0;i<t.calculated.length;i++)n("input#"+t.calculated[i].Row+"_"+t.calculated[i].Column).val(t.calculated[i].Value);try{n("input#"+t.changed.Row+"_"+t.changed.Column).val(t.changed.Value)}catch(r){alert("Не заполнена структура ответа PostBackData: "+r.toString())}}},error:function(n){alert(n.responseText)}})):(h=w(i[2],n(this).prop("min"),n(this).prop("max"),t.sgrid("getSettings","decimalDelimiter"),t.sgrid("getSettings","dateDelimiter")),o(e,s,h)))})}function y(t){n("#stbody a").on("click",function(i){i.preventDefault();var r=n(this).attr("id").split("_",2);t.sgrid("setForm",0,r[0],r[1]);window.history.pushState({idForm:n(this).attr("href")},null,null)});window.onpopstate=function(n){if(n.state==null){t.sgrid("setForm",t.sgrid("getStartFormId"),0,0);return}t.sgrid("getIdForm")!==n.state.idForm&&t.sgrid("setForm",n.state.idForm,0,0)};n(t).on("formReady.sgrid",function(t){t.preventDefault();n(this).off("formReady.sgrid")});n(t).sgrid("getSettings","readOnly")===!0&&n(t).sgrid("getSettings","hasTreeColumn")===!1&&(n("th span.glyphicon").filter(".glyphicon-sort",".glyphicon-sort-by-attributes",".glyphicon-sort-by-attributes-alt").click(function(n){b(n.currentTarget.parentNode.cellIndex,t)}),n("th span.glyphicon-filter").click(function(i){n(t).sgrid("initFilterDialog",i.currentTarget.parentElement.cellIndex,i.currentTarget.parentElement.innerText)}));n("td > span.sgrid-expander").click(function(){var u=n(this),f=null,s=n(n(this).closest("tr")).attr("row"),i,r,e,o;if(u.hasClass("glyphicon-minus")?(u.removeClass("glyphicon-minus").addClass("glyphicon-plus"),f=!0):u.hasClass("glyphicon-plus")&&(u.removeClass("glyphicon-plus").addClass("glyphicon-minus"),f=!1),f!==null){for(i=[],r=t.sgrid("getChildRows",s),i=r.slice(),e=0;e<i.length;e++)for(r=t.sgrid("getChildRows",i[e]),o=0;o<r.length;o++)i.push(r[o]);i.forEach(function(n){f===!0?t.sgrid("hideRow",n):t.sgrid("showRow",n)})}});n("td").click(function(i){n(i.target.children).hasClass("glyphicon-pencil")&&t.sgrid("initModalRowEdit",n(i.target).parent(),n(i.target).text());i.preventDefault()});n("#dlgBtnSave").click(function(){var r=[],u={Row:0,Column:0,Value:"",Type:0},e=n("#ModalEdit"),o=t.sgrid("getSettings","dateDelimiter"),s=t.sgrid("getSettings","decimalDelimiter"),i,f;for(e.find("input , select").each(function(t,i){var f=n(i).prop("name").split("_",3),e=n(i).prop("value");u={Row:f[0],Column:f[1],Value:e,Type:f[2]};r.push(u)}),n("#ModalEdit").modal("hide"),i=0;i<r.length;i++)f=r[i].Row+"_"+r[i].Column,n("#"+f,"div.sgrid_container").prop("value",r[i].Value)});n("#dlgBtnFilter").click(function(){var r=n("#FilterDlg"),i="";n("#filterSelect",r).find(":selected").each(function(t,r){i=n(r).val()});i===""?t.sgrid("showAll"):t.sgrid("showOnly",i)})}function p(n,t,i,r,u,f){var e,o="^(0[1-9]|[12][0-9]|3[01])\\"+u+"(0[1-9]|1[012])\\"+u+"\\d{1,4}";switch(n){case"1":t=t.replace(/\s+/g,"");e=new RegExp("^[-+]?[0-9]*\\"+f+"?[0-9]+$");break;case"5":t=t.replace(/\s+/g,"");e=new RegExp(/^[-+]?\d+$/);break;case"3":e=new RegExp(o+"$");break;case"4":e=new RegExp(o+"[ \\u00A0]+(\\d{2}[:]){1,2}\\d{2}$");break;case"6":return e=new RegExp(/^[-+]?\d+$/),e.test(t)?Number(t)>=Number(i)&&Number(t)<=Number(r)?!0:!1:!1;default:return!0}return e.test(t)}function o(t,i,r){n(".popup").css("left",t+n(".popup").css("width").replace("px","")/2);n(".popup").css("top",i+n(".popup").css("height").replace("px","")/2);n("#inputerror").html(r);n(".popup, .close_order, .overlay").click(function(){n(".popup, .overlay").css({opacity:"0",visibility:"hidden"})});n(".popup, .overlay").css({opacity:"1",visibility:"visible"})}function w(n,t,i,r,u){switch(n){case"1":return"Введите вещественное число. Разделитель - "+r;case"2":return"Введите текст";case"3":return"Требуется дата в формате дд"+u+"мм"+u+"гггг ";case"4":return"Дата и время в формате дд"+u+"мм"+u+"гггг чч:мин:сек ";case"5":return"Требуется целое число";case"6":return"Требуется целое число от "+t+" до "+i;case"8":return"Введите текст";case"9":return"";case"10":return"Выберите из списка";default:return""}}function s(t){t==="show"?(n("#mod-progress").modal("show"),arguments.length>=2?n("#progressBarParagraph").text(arguments[1]):n("#progressBarParagraph").text("??..."),window.progressBarActive=!0):(n("#mod-progress").modal("hide"),window.progressBarActive=!1)}function b(t,i){function o(t,r,u){var s=2,h=1,c=0,f=0,l=n(i).sgrid("getSettings","dateDelimiter"),e=t.split(l),o=r.split(l);return f=u?parseInt(e[s])-parseInt(o[s]):parseInt(o[s])-parseInt(e[s]),f===0?(f=u?parseInt(e[h])-parseInt(o[h]):parseInt(o[h])-parseInt(e[h]),f===0?u?parseInt(e[c])-parseInt(o[c]):parseInt(o[c])-parseInt(e[c]):f):f}function h(n,t,i){var r=o(n,t,i);if(r===0){n=n.split(" ")[1];t=t.split(" ")[1];var e=0,s=1,h=2,u=n.split(":"),f=t.split(":");return r=i?parseInt(u[e])-parseInt(f[e]):parseInt(f[e])-parseInt(u[e]),r===0?(r=i?parseInt(u[s])-parseInt(f[s]):parseInt(f[s])-parseInt(u[s]),r===0&&(r=i?parseInt(u[h])-parseInt(f[h]):parseInt(f[h])-parseInt(u[h])),r):r}return r}var s=i,u=[],r=!0,f,e;n("span.glyphicon").filter(".glyphicon-sort",".glyphicon-sort-by-attributes",".glyphicon-sort-by-attributes-alt").each(function(i){if(i===t){var u="h";n(this).hasClass("glyphicon-sort-by-attributes")&&(u="a");n(this).hasClass("glyphicon-sort-by-attributes-alt")&&(u="d");n(this).removeClass("glyphicon-sort-by-attributes glyphicon-sort-by-attributes-alt");(u==="h"||u==="d")&&(n(this).addClass("glyphicon-sort-by-attributes active"),r=!0);u==="a"&&(n(this).addClass("glyphicon-sort-by-attributes-alt active"),r=!1)}else n(this).removeClass().addClass("header").addClass("glyphicon glyphicon-sort")});f=function(){this.Key="";this.KeyType=0;this.Cells=[]};e=n(s).find("tbody tr").each(function(){var i=new f;n(this).children().each(function(r){var u=n(this).text().replace(/(\r\n|\n|\r)/gm," ");r===t&&(i.Key=u,i.KeyType=n(this).attr("dataType"));i.Cells.push(u)});u.push(i)});u.sort(function(t,u){var s=n(i).sgrid("getSettings","decimalDelimiter"),f,e;switch(t.KeyType){case"2":case"8":case"7":if(t.Key===u.Key)return 0;if(t.Key>u.Key)return r?1:-1;if(t.Key<u.Key)return r?-1:1;break;case"1":return f=t.Key.replace(s,"."),e=u.Key.replace(s,"."),r?parseFloat(f)-parseFloat(e):parseFloat(e)-parseFloat(f);case"5":case"6":return r?t.Key-u.Key:u.Key-t.Key;case"3":return o(t.Key,u.Key,r);case"4":return h(t.Key,u.Key,r)}});e.each(function(t){var i=u[t];n(this).children().each(function(t){n(this).text(i.Cells[t])})})}function k(n){for(var r,i={},t=0;t<n.length;t++)r=n[t],i[r]=!0;return Object.keys(i)}var f="",t=null,h=100,i=[],e="",r="",u={initGrid:function(i){var r=n.extend({},{geturl:null,posturl:null,getImgUrl:null,cellsDataUrl:null,showAlert:!1,decimalDelimiter:",",dateDelimiter:"/",formMode:"Input",readOnly:!1,root:"",hasTreeColumn:!1,expanderTemplate:'<span class="sgrid-expander"><\/span>',indentTemplate:'<span class="sgrid-indent"><\/span>',expanderExpandedClass:"glyphicon glyphicon-minus",expanderCollapsedClass:"glyphicon glyphicon-plus",modalRowEdit:!1,nameRow4Modal:null,nameCol4Modal:null,filterColumns:null,formId:0},i);return this.each(function(){var i=n(this);i.sgrid("setGridContainer",n(this));i.sgrid("setSettings",r);t=r.formId;i.sgrid("setForm",0);i.sgrid("createProgressBar",n(this));r.modalRowEdit==="true"&&i.sgrid("createModalEdit",n(this));r.filterColumns!==null&&r.filterColumns.length>0&&i.sgrid("createFilterDialog",n(this))})},setGridContainer:function(t){return n(this).data("sgrid",t)},getGridContainer:function(){return n(this).data("sgrid")},getSettings:function(t){return n(this).sgrid("getGridContainer")?n(this).sgrid("getGridContainer").data("settings")[t]:null},setSettings:function(t){n(this).sgrid("getGridContainer").data("settings",t)},changeSetting:function(t,i){n(this).sgrid("getGridContainer").data("settings")[t]=i},createProgressBar:function(t){var u=n('<div class="modal fade in" id="mod-progress" role="dialog">').appendTo(t),i=n("<div>").addClass("modal-dialog").appendTo(u),r=n("<div>").addClass("modal-content").appendTo(i),f=n("<div>").addClass("modal-body").appendTo(r);i=n("<div>").addClass("text-center").appendTo(f);i=n('<div id="result" style="font-size: 1.1em; padding-bottom: 5px">').appendTo(i);n('<p id="progressBarParagraph">').appendTo(i);i=n('<div id="ProgressStripe" class="progress progress-striped active" style="position:relative; top:10px; width:100%;">').insertAfter(i);n('<div id="ProgressMessage" class="progress-bar progress-bar-info" style="width: 100%; border:none;"><\/div>').appendTo(i);n('<div class="modal-footer">').html("Остановить процесс - Esc").appendTo(r)},createModalEdit:function(t){var f=n('<div class="modal fade" id="ModalEdit" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true">').appendTo(t),e=n('<div class="modal-dialog" max-height:100%;  margin-top: 50px; margin-bottom:50px;">').appendTo(f),i=n('<div class="modal-content">').appendTo(e),r=n('<div class="modal-header">').appendTo(i),u=n('<button type="button" class="close" data-dismiss="modal">').appendTo(r);n('<span aria-hidden="true">&times;<\/span>').appendTo(u);n('<span class="sr-only">Close<\/span>').appendTo(u);n('<h4 class="modal-title" id="ModalLabel">Modal title<\/h4>').appendTo(r);var o=n('<div class="modal-body">').appendTo(i),h=n('<form class="form-horizontal" role="form">').appendTo(o),s=n('<div class="modal-footer">').appendTo(i);n('<button type="button" class="btn btn-primary" id="dlgBtnSave">Закрыть<\/button>').appendTo(s)},initModalRowEdit:function(t,r){var u=n("#ModalEdit"),f=u.find("div.modal-body");f.children().remove();n("#ModalLabel").text(r);t.children().each(function(t,r){var e,u,o;n(r).hasClass("cell_input")===!0&&(e=n('<form class="form-horizontal" role="form">').appendTo(f),u=n('<div class="form-group">').appendTo(e),n('<label  class="col-md-6 control-label">'+i[t]+"<\/label>").appendTo(u),o=n('<div class="col-md-6">').appendTo(u),n(r).find("input:enabled , select:enabled , textarea:enabled").clone(!0).appendTo(o))});u.modal("show")},createFilterDialog:function(t){var e=n('<div class="modal fade" id="FilterDlg" tabindex="-1" role="dialog" aria-labelledby="FilterDlgLabel" aria-hidden="true">').appendTo(t),o=n('<div class="modal-dialog" max-height:100%;  margin-top: 50px; margin-bottom:50px;">').appendTo(e),i=n('<div class="modal-content">').appendTo(o),r=n('<div class="modal-header">').appendTo(i),u=n('<button type="button" class="close" data-dismiss="modal">').appendTo(r);n('<span aria-hidden="true">&times;<\/span>').appendTo(u);n('<span class="sr-only">Close<\/span>').appendTo(u);n('<h4 class="modal-title" id="FilterDlgLabel"><\/h4>').appendTo(r);var s=n('<div class="modal-body">').appendTo(i),h=n('<form class="form-horizontal" role="form">').appendTo(s),f=n('<div class="form-group">',"#FilterDlg").appendTo(h);n('<label  class="col-md-6 control-label">Выберите из списка<\/label>').appendTo(f);var c=n('<div class="col-md-6">',"#FilterDlg").appendTo(f),a=n('<select id="filterSelect"><\/select>').appendTo(c),l=n('<div class="modal-footer">').appendTo(i);n('<button type="button" class="btn btn-primary" id="dlgBtnFilter" data-dismiss="modal">Фильтровать<\/button>').appendTo(l)},initFilterDialog:function(t,i){var o=[],u,f,r;for(e=t,n("td[id*=_"+t+"]").each(function(){o.push(this.innerText)}),u=k(o),n("#FilterDlgLabel").text(i),f=n("#filterSelect","#FilterDlg"),f.children().remove(),n("<option>").attr("value","").text("").appendTo(f),r=0;r<u.length;r++)n("<option>").attr("value",u[r]).text(u[r]).appendTo(f);n("#FilterDlg").modal("show")},showAll:function(){n("tr:hidden",this).show()},showOnly:function(t){n("td[id*=_"+e+"]").each(function(){this.innerText==t?n(this).parent("tr").show():n(this).parent("tr").hide()})},setIdForm:function(n){f=n},getIdForm:function(){return f},getStartFormId:function(){return t},setParams:function(n){r=n},setForm:function(i){var u,f;return t===null&&(t=i),u=n(this),u.sgrid("clearForm"),u.sgrid("setIdForm",i),f=u.sgrid("getSettings","root")+u.sgrid("getSettings","geturl"),r.length>0&&(f+=r),n.ajax({type:"GET",url:f,success:function(n){var t=u.sgrid("getSettings","readOnly");c(n,u);t===!0?a(n,u):l(n,u,u.sgrid("getSettings","dateDelimiter"));v(u);y(u);u.trigger("formReady.sgrid");u.sgrid("setPencil")},error:function(n){alert("Ошибка чтения данных. Статус -  "+n.status+" Техт: "+n.responseText)}})},clearForm:function(){var t=n(this).sgrid("getGridContainer");n(t).find("div").remove()},updateCell:function(t,i,r,u,f){var e=null,o,s,h,c;if(u===7){t="td"+t;e=n("[id='"+t+"']");e.addClass("cell_error").attr("title",i);return}if(u===6){t=t+"_th";e=n("[id='"+t+"']");e[0].innerText=i;return}if((o=n(this).sgrid("getGridContainer"),s=(u==1||u==3)&&!n(o).sgrid("getSettings","readOnly"),e=n("[id='"+t+"']"),e!==null&&e!==undefined)&&(n("td#td"+t).attr("title",f),s?e.removeAttr("disabled"):e.attr("disabled","disabled"),e.length>0))switch(r){case 1:case 2:case 3:case 4:case 5:case 6:case 8:e[0].localName==="input"?e[0].value=i:e[0].innerText=i;break;case 7:h=n(e[0]);h.prop("checked",i);break;case 9:n(e[0]).attr("src",o.sgrid("getSettings","root")+o.sgrid("getSettings","posturl")+"?id="+i);break;case 10:c=n(e[0]).children("option").removeAttr("selected");c.each(function(t,r){r.value===i&&n(r).attr("selected","selected")});break;case 11:n(e[0]).attr("href",i)}},changeMode:function(t){if(settings.formMode!==t){switch(t){case"Input":n(selector+" td.cell_input").children().removeAttr("disabled");n(selector+" td.cell_fromhistory").children().attr("disabled","disabled");break;case"History":n(selector+" td.cell_input").children().attr("disabled","disabled");n(selector+" td.cell_fromhistory").children().removeAttr("disabled");break;default:alert("mode может принимать значения: Input , History !")}settings.formMode=t}},getCellsData:function(t){var r=!1,i=n(this);n(document).keydown(function(n){n.which==27&&(r=!0)});n.ajax({url:i.sgrid("getSettings","root")+i.sgrid("getSettings","cellsDataUrl")+"?i="+t.toString(),async:!0,cache:!1,success:function(u){if(n.each(u.cells,function(n,t){i.sgrid("updateCell",t.Row+"_"+t.Column,t.Value,t.Type,t.Mode,t.Tooltip)}),s("show","Выполнено "+u.Percent+"%"),n("#ProgressMessage").width(u.Percent+"%"),u.Percent>="100"||r||t>=h){s();i.trigger("dataReady.sgrid");return}i.sgrid("getCellsData",t++)},error:function(n){alert("Ошибка чтения данных. Статус -  "+n.status+" Техт: "+n.responseText)}})},getChildRows:function(t){var r=n(this),i=[];return r.find("tbody").find("tr").each(function(r,u){n(u).attr("parentrow")===t&&i.push(n(u).attr("row"))}),i},hideRow:function(t){n("tr[row="+t+"]").hide()},showRow:function(t){n("tr[row="+t+"]").show()},setPencil:function(){var t=n(this),i=t.sgrid("getSettings","nameCol4Modal");t.sgrid("getSettings","modalRowEdit")=="true"&&n("tr td").each(function(t,r){var u=r.id.split("_",2);u.length>1&&u[1]===i&&n(r).prepend('<span class="glyphicon glyphicon-pencil"><\/span>')})},addRemoveIcon:function(){var t=n(this);n("tbody tr td:first-child",t).prepend('<span class="glyphicon glyphicon-remove"><\/span>');n("tbody tr:last td span",t).removeClass("glyphicon-remove").addClass("glyphicon-plus-sign")},onRemoveRowEvnt:function(){var t=n(this);n("td > span.glyphicon-remove").click(function(i){var r=n(i.target.parentElement),u=r.attr("id").replace("td",""),f=u.slice("_");t.sgrid("rowDeleted",f[0]);r.parent().remove()})},onAddRowEvnt:function(){var t=n(this);n("td > span.glyphicon-plus-sign").click(function(i){var r=n(i.target.parentElement),u=r.attr("id").replace("td",""),f=u.slice("_");t.sgrid("addRow",f[0])})},offRemoveRowEvnt:function(){n("td > span.glyphicon-remove").off("click")},offAddRowEvnt:function(){n("td > span.glyphicon-plus-sign").off("click")},rowDeleted:function(t){n(this).trigger("rowChanged.sgrid",[t,0])},addRow:function(t){var i=n(this),r;i.sgrid("offRemoveRowEvnt");i.sgrid("offAddRowEvnt");r=parseInt(t)+1;n("tbody tr:last td:first span",i).removeClass("glyphicon-plus-sign").addClass("glyphicon-remove");n("tbody tr:last",i).clone(!0).appendTo("tbody");n("tbody tr:last td:first span",i).removeClass("glyphicon-remove").addClass("glyphicon-plus-sign");n("tbody tr:last td",i).each(function(i,u){var f=n(u).prop("id"),e=f.replace("td"+t,"td"+r);n(u).prop("id",e);n("input , textarea , select",n(u)).each(function(i,u){var o=n(u).prop("name"),s=o.replace(t+"_",r+"_"),f,e;n(u).prop("name",s);f=n(u).prop("id");e=f.replace(t+"_",r+"_");n(u).prop("id",e);n(u).prop("value","")})});i.sgrid("onRemoveRowEvnt");i.sgrid("onAddRowEvnt");n(this).trigger("rowChanged.sgrid",[r,1])},hideEmptyRows:function(t){for(var r,f,o=n(this),u=n("tbody tr",o),i=0;i<u.length;i++){var s=u[i],e=!0,h=n("td",n(s));for(r=0;r<t.length;r++)if(f=n(h[t[r]]).html(),!(f==="0"||f==="")){e=!1;break}e&&n(u[i]).attr("hidden","hidden")}},showAllRow:function(){var t=n(this);n("tbody tr",t).removeAttr("hidden")}};n.fn.sgrid=function(t){if(u[t])return u[t].apply(this,Array.prototype.slice.call(arguments,1));if(typeof t!="object"&&t)n.error("Method with name "+t+" does not exists for jQuery.sgrid");else return u.initGrid.apply(this,arguments)}}(jQuery);